<html>

<head>
    <script src="https://www.amcharts.com/lib/3/ammap.js" type="text/javascript"></script>
    <script src="https://www.amcharts.com/lib/3/maps/js/worldHigh.js" type="text/javascript"></script>
    <script src="https://www.amcharts.com/lib/3/themes/dark.js" type="text/javascript"></script>
</head>

<body>
    <div id="mapdiv" style="width: 100%; height: 80%;"></div>
    <script type="text/javascript">
        function createChart(country) {
            var map = AmCharts.makeChart("mapdiv", {
                type: "map",
                theme: "dark",
                projection: "mercator",
                panEventsEnabled: true,
                backgroundColor: "#535364",
                backgroundAlpha: 1,
                zoomControl: {
                    zoomControlEnabled: true
                },
                dataProvider: {
                    map: "worldHigh",
                    getAreasFromMap: true,
                    areas: [{
                        "id": country,
                        "showAsSelected": true
                    }]
                },
                areasSettings: {
                    autoZoom: true,
                    color: "#B4B4B7",
                    colorSolid: "#84ADE9",
                    selectedColor: "#84ADE9",
                    outlineColor: "#666666",
                    rollOverColor: "#9EC2F7",
                    rollOverOutlineColor: "#000000"
                }
            });
        }

        function updateMap() {
          const url = 'http://localhost:5000/'
          return fetch(url)
            .then(data => data.json())
            .then(json => json['abbreviation'])
            .then(country => createChart(country))
        }

        setInterval(updateMap, 3000)
    </script>
</body>

</html>
